(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const s of c.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function i(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(o){if(o.ep)return;o.ep=!0;const c=i(o);fetch(o.href,c)}})();const W="modulepreload",H=function(e){return"/Teleprompter/"+e},I={},P=function(n,i,a){let o=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),l=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));o=Promise.allSettled(i.map(p=>{if(p=H(p),p in I)return;I[p]=!0;const g=p.endsWith(".css"),f=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${f}`))return;const u=document.createElement("link");if(u.rel=g?"stylesheet":W,g||(u.as="script"),u.crossOrigin="",u.href=p,l&&u.setAttribute("nonce",l),document.head.appendChild(u),g)return new Promise((d,T)=>{u.addEventListener("load",d),u.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${p}`)))})}))}function c(s){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s}return o.then(s=>{for(const l of s||[])l.status==="rejected"&&c(l.reason);return n().catch(c)})};function A(e={}){const{immediate:n=!1,onNeedRefresh:i,onOfflineReady:a,onRegistered:o,onRegisteredSW:c,onRegisterError:s}=e;let l,p;const g=async(u=!0)=>{await p};async function f(){if("serviceWorker"in navigator){const{Workbox:u}=await P(async()=>{const{Workbox:d}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:d}},[]);l=new u("/Teleprompter/sw.js",{scope:"/Teleprompter/",type:"classic"}),l.addEventListener("activated",d=>{(d.isUpdate||d.isExternal)&&window.location.reload()}),l.addEventListener("installed",d=>{d.isUpdate||a==null||a()}),l.register({immediate:n}).then(d=>{c?c("/Teleprompter/sw.js",d):o==null||o(d)}).catch(d=>{s==null||s(d)})}}return p=f(),g}A({immediate:!0});const r={isListening:!1,scriptWords:[],currentIndex:0,recognition:null,isMirrored:!1,config:{fontSize:20,lineHeight:1.5,textColor:"#ffffff",bgColor:"#000000",textAlign:"center",showStopIcon:!1}},t={setupScreen:document.getElementById("setupScreen"),prompterContainer:document.getElementById("prompterContainer"),inputScript:document.getElementById("inputScript"),scriptContent:document.getElementById("scriptContent"),scrollContainer:document.getElementById("scrollContainer"),topSpacer:document.getElementById("topSpacer"),settingsPanel:document.getElementById("settingsPanel"),fontSizeInput:document.getElementById("fontSizeInput"),fontSizeVal:document.getElementById("fontSizeVal"),lineHeightInput:document.getElementById("lineHeightInput"),lineHeightVal:document.getElementById("lineHeightVal"),textColorInput:document.getElementById("textColorInput"),bgColorInput:document.getElementById("bgColorInput"),appBody:document.getElementById("appBody"),micButton:document.getElementById("micButton"),micIcon:document.getElementById("micIcon"),statusIndicator:document.getElementById("statusIndicator"),mirrorBtn:document.getElementById("mirrorBtn"),mirrorToggleKnob:document.getElementById("mirrorToggleKnob"),browserWarning:document.getElementById("browserWarning"),historyList:document.getElementById("historyList"),historySection:document.getElementById("historySection"),stopSignToggle:document.getElementById("stopSignToggle"),alignBtns:{left:document.getElementById("alignLeftBtn"),center:document.getElementById("alignCenterBtn"),right:document.getElementById("alignRightBtn")},loadScriptBtn:document.getElementById("loadScriptBtn"),clearHistoryBtn:document.getElementById("clearHistoryBtn"),resetAppBtn:document.getElementById("resetAppBtn"),restartScriptBtn:document.getElementById("restartScriptBtn"),toggleSettingsBtn:document.getElementById("toggleSettingsBtn"),themeDarkBtn:document.getElementById("themeDarkBtn"),themeLightBtn:document.getElementById("themeLightBtn"),copyScriptBtn:document.getElementById("copyScriptBtn"),clearScriptBtn:document.getElementById("clearScriptBtn"),pasteScriptBtn:document.getElementById("pasteScriptBtn")},E=window.SpeechRecognition||window.webkitSpeechRecognition;E?(r.recognition=new E,r.recognition.continuous=!0,r.recognition.interimResults=!0,r.recognition.lang="en-US"):t.browserWarning.classList.remove("hidden");v();F();function C(e=null){let n=e||t.inputScript.value.trim();if(!n)return alert("Please enter some text.");e||_(n),n=n.replace(/\n+/g," ||LB|| ");const i=n.split(/\s+/);let a=!1;r.scriptWords=i.map(o=>{if(o==="||LB||")return{word:"ðŸ›‘",clean:"",element:null,skip:!0,isStop:!0};o.startsWith("[")&&(a=!0);const c=o.toLowerCase().replace(/[^\w\s]|_/g,"").replace(/\s+/g," "),s=c.length===0,l=a||s||o.includes("ðŸ›‘");return o.endsWith("]")&&(a=!1),{word:o,clean:c,element:null,skip:l,isStop:!1}}),t.scriptContent.innerHTML="",r.scriptWords.forEach((o,c)=>{const s=document.createElement("span");s.textContent=o.word,s.id=`word-${c}`;let l="script-word transition-opacity duration-300 ";o.isStop?l+="stop-marker ":o.skip?l+="skipped-word ":l+="text-future hover:text-blue-400 ",s.className=l,s.onclick=()=>{o.skip||(r.currentIndex=c,m(),B())},t.scriptContent.appendChild(s),o.element=s}),r.config.showStopIcon?t.scriptContent.classList.add("show-stops"):t.scriptContent.classList.remove("show-stops"),t.setupScreen.classList.add("hidden"),t.prompterContainer.classList.remove("hidden"),r.currentIndex=0,L(),m()}function L(){for(;r.currentIndex<r.scriptWords.length&&r.scriptWords[r.currentIndex].skip;)r.currentIndex++}function O(){k(),t.prompterContainer.classList.add("hidden"),t.setupScreen.classList.remove("hidden"),v()}function b(){r.currentIndex=0,L(),m(),B(),t.scrollContainer.scrollTop=0}function _(e){let n=JSON.parse(localStorage.getItem("teleprompter_history")||"[]");if(n.length>0&&n[0].text===e)return;const i={id:Date.now(),text:e,preview:e.substring(0,40)+(e.length>40?"...":""),date:new Date().toLocaleDateString()};n.unshift(i),n.length>10&&n.pop(),localStorage.setItem("teleprompter_history",JSON.stringify(n))}function v(){let e=JSON.parse(localStorage.getItem("teleprompter_history")||"[]");if(t.historyList.innerHTML="",e.length===0){t.historyList.innerHTML=`
            <div class="text-center py-8 border border-dashed border-neutral-800 rounded-lg text-neutral-600 text-sm">
                No previous scripts found
            </div>
        `,t.clearHistoryBtn.classList.add("hidden");return}t.clearHistoryBtn.classList.remove("hidden"),e.forEach(n=>{const i=document.createElement("div");i.className="bg-neutral-800 p-3 rounded border border-neutral-700 hover:border-blue-500 cursor-pointer transition group flex justify-between items-center shadow-sm",i.onclick=()=>{t.inputScript.value=n.text,C(n.text)},i.innerHTML=`
            <div class="flex flex-col text-left overflow-hidden mr-2">
                <span class="text-gray-300 text-sm font-medium truncate font-mono">${n.preview}</span>
                <span class="text-gray-500 text-xs">${n.date}</span>
            </div>
            <div class="flex-shrink-0">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-blue-500 opacity-0 group-hover:opacity-100 transition" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
            </div>
        `,t.historyList.appendChild(i)})}function M(){confirm("Clear all recent scripts?")&&(localStorage.removeItem("teleprompter_history"),v())}r.recognition&&(r.recognition.onresult=e=>{let n="";for(let o=e.resultIndex;o<e.results.length;o++)n+=e.results[o][0].transcript;const i=n.trim().toLowerCase().split(/\s+/);if(i.slice(-5).join(" ").includes("prompter restart")){b();return}z(i.slice(-5))},r.recognition.onend=()=>{if(r.isListening)try{r.recognition.start()}catch{}else S(!1)});function z(e){if(r.currentIndex>=r.scriptWords.length)return;const n=5;for(let i of e){const a=i.replace(/[^\w]|_/g,"");if(!a)continue;let o=r.currentIndex,c=0;for(;o<r.scriptWords.length&&c<n;){const s=r.scriptWords[o];if(s.skip){o++;continue}if(s.clean===a){r.currentIndex=o+1,L(),m(),B();return}o++,c++}}}function m(){r.scriptWords.forEach((e,n)=>{e.skip||e.isStop||e.element&&(n<r.currentIndex?(e.element.classList.remove("text-future","current-word","font-bold"),e.element.classList.add("text-past"),e.element.style.opacity=""):n===r.currentIndex?(e.element.classList.remove("text-future","text-past"),e.element.classList.add("current-word","font-bold"),e.element.style.opacity="1"):(e.element.classList.remove("text-past","current-word","font-bold"),e.element.classList.add("text-future"),e.element.style.opacity=""))})}function B(){if(r.currentIndex>0&&r.currentIndex<r.scriptWords.length){const e=r.scriptWords[r.currentIndex].element;if(e){const n=t.scrollContainer.clientHeight,i=e.offsetTop-n/3;t.scrollContainer.scrollTo({top:i,behavior:"smooth"})}}}function N(){if(!r.recognition)return alert("Speech recognition not supported.");r.isListening?k():$()}function $(){try{r.recognition.start(),r.isListening=!0,S(!0)}catch(e){console.error(e)}}function k(){r.isListening=!1,r.recognition.stop(),S(!1)}function S(e){const n=t.micButton,i=t.statusIndicator;e?(n.classList.add("bg-red-600","border-red-400","recording-pulse"),n.classList.remove("bg-neutral-800","border-neutral-600"),i.classList.remove("hidden")):(n.classList.remove("bg-red-600","border-red-400","recording-pulse"),n.classList.add("bg-neutral-800","border-neutral-600"),i.classList.add("hidden"))}function x(){const e=t.settingsPanel;e.classList.contains("hidden")?(e.classList.remove("hidden"),setTimeout(()=>{e.classList.remove("scale-95","opacity-0"),e.classList.add("scale-100","opacity-100")},10)):(e.classList.remove("scale-100","opacity-100"),e.classList.add("scale-95","opacity-0"),setTimeout(()=>{e.classList.add("hidden")},200))}function w(e){e==="dark"?(r.config.bgColor="#000000",r.config.textColor="#ffffff"):(r.config.bgColor="#ffffff",r.config.textColor="#000000"),t.bgColorInput.value=r.config.bgColor,t.textColorInput.value=r.config.textColor,y()}function h(e){r.config.textAlign=e,t.scriptContent.style.textAlign=e,["left","center","right"].forEach(n=>{const i=t.alignBtns[n];n===e?(i.classList.remove("hover:bg-neutral-600"),i.classList.add("bg-neutral-500","text-white")):(i.classList.add("hover:bg-neutral-600"),i.classList.remove("bg-neutral-500","text-white"))})}function y(){t.appBody.style.backgroundColor=r.config.bgColor,t.appBody.style.color=r.config.textColor}function D(){r.isMirrored=!r.isMirrored;const e=t.mirrorToggleKnob,n=t.mirrorBtn;r.isMirrored?(t.scriptContent.classList.add("mirror-mode"),e.classList.add("translate-x-6"),n.classList.add("bg-blue-600"),n.classList.remove("bg-neutral-600")):(t.scriptContent.classList.remove("mirror-mode"),e.classList.remove("translate-x-6"),n.classList.remove("bg-blue-600"),n.classList.add("bg-neutral-600"))}async function R(){const e=t.inputScript.value;if(e)try{await navigator.clipboard.writeText(e);const n=t.copyScriptBtn,i=n.innerHTML;n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg> Copied!',setTimeout(()=>{n.innerHTML=i},1500)}catch(n){console.error("Failed to copy:",n),alert("Failed to copy to clipboard")}}function U(){t.inputScript.value="",t.inputScript.focus()}async function V(){try{const e=await navigator.clipboard.readText();t.inputScript.value=e,t.inputScript.focus()}catch(e){console.error("Failed to paste:",e),alert("Failed to paste from clipboard. Please grant clipboard permissions or paste manually.")}}function F(){t.loadScriptBtn.addEventListener("click",()=>C()),t.clearHistoryBtn.addEventListener("click",M),t.resetAppBtn.addEventListener("click",O),t.restartScriptBtn.addEventListener("click",b),t.micButton.addEventListener("click",N),t.toggleSettingsBtn.addEventListener("click",x),t.themeDarkBtn.addEventListener("click",()=>w("dark")),t.themeLightBtn.addEventListener("click",()=>w("light")),t.copyScriptBtn.addEventListener("click",R),t.clearScriptBtn.addEventListener("click",U),t.pasteScriptBtn.addEventListener("click",V),t.alignBtns.left.addEventListener("click",()=>h("left")),t.alignBtns.center.addEventListener("click",()=>h("center")),t.alignBtns.right.addEventListener("click",()=>h("right")),t.stopSignToggle.addEventListener("change",e=>{r.config.showStopIcon=e.target.checked,r.config.showStopIcon?t.scriptContent.classList.add("show-stops"):t.scriptContent.classList.remove("show-stops")}),t.fontSizeInput.addEventListener("input",e=>{const n=e.target.value;r.config.fontSize=parseInt(n),t.fontSizeVal.textContent=`${n}px`,t.scriptContent.style.fontSize=`${n}px`}),t.lineHeightInput.addEventListener("input",e=>{const n=e.target.value;r.config.lineHeight=parseFloat(n),t.lineHeightVal.textContent=`${n}x`,t.scriptContent.style.lineHeight=n}),t.textColorInput.addEventListener("input",e=>{r.config.textColor=e.target.value,y()}),t.bgColorInput.addEventListener("input",e=>{r.config.bgColor=e.target.value,y()}),t.mirrorBtn.addEventListener("click",D),document.addEventListener("click",e=>{const n=t.settingsPanel,i=t.toggleSettingsBtn;!n.classList.contains("hidden")&&!n.contains(e.target)&&!i.contains(e.target)&&x()})}
